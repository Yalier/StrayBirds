---
title: 自动释放池和消息循环
layout: post
category: 技术
comments: false

---





- 主线程会默认开启一个消息循环，开启消息循环时会有一个自动释放池，每次消息循环中加入一些事件对象，就是添加到自动释放池中，当事件执行完成后，自动释放池会将里面所有对象释放掉，消息循环就等待下一次事件。

- 如果一个循环中创建了多个临时的对象，会造成内存泄漏，需要在循环中创建一个自动释放池释放对象。


- 创建一个子线程时，创建一个自动释放池，因为，子线程中无法使用主线程的自动释放池

- 所有的线程中都有一个消息循环，子线程中的消息循环默认是关闭着的，可以调用 [[NSRunLoop currentRunLoop] run] 方法开启消息循环,这个方法开启的默认模式是default的，并且如果里面没有加入输入事件，就回立刻关闭消息循环, 加入了输入事件，就不会关闭。也可以用其他run方法指定模式。


- 消息循环是在一个指定的模式下运行的，加入到消息循环的输入源必须和消息循环模式一致，才能执行

- 消息循环的目的：

                  1.保证程序不退出
				  2.负责处理输入事件和定时源
			      3.如果没有时间发生，会让程序进入休眠状态

	